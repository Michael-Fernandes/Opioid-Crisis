{"ast":null,"code":"import _classCallCheck from \"/Users/fernb0t/Code/react/Opioid Crisis/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/fernb0t/Code/react/Opioid Crisis/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/fernb0t/Code/react/Opioid Crisis/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/fernb0t/Code/react/Opioid Crisis/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/fernb0t/Code/react/Opioid Crisis/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/fernb0t/Code/react/Opioid Crisis/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport * as ReactFauxDOM from 'react-faux-dom';\nimport data from \"../../Resources/data.json\";\nimport colors from \"../../Resources/colors.json\";\nimport sizeMe from \"react-sizeme\";\n\nvar Chart =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Chart, _Component);\n\n  function Chart(props) {\n    var _this;\n\n    _classCallCheck(this, Chart);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Chart).call(this, props));\n    _this.state = {\n      innerWidth: window.innerWidth\n    };\n    _this.makeD3 = _this.makeD3.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.getActive = _this.getActive.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.getDataFor = _this.getDataFor.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.updateDimensions = _this.updateDimensions.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Chart, [{\n    key: \"getActive\",\n    value: function getActive() {\n      var countries = this.props.countries;\n      var active = countries.filter(function (el) {\n        return el.active === true;\n      }); // I have no idea but this call drops data.....\n\n      return active;\n    }\n  }, {\n    key: \"getDataFor\",\n    value: function getDataFor(country) {\n      var gender = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"Both\";\n      return country['data'][[gender]].sort(function (a, b) {\n        return a.year - b.year;\n      });\n    }\n  }, {\n    key: \"updateDimensions\",\n    value: function updateDimensions() {\n      this.setState({\n        innerWidth: window.innerWidth\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener(\"resize\", this.updateDimensions);\n    }\n  }, {\n    key: \"makeD3\",\n    value: function makeD3() {\n      var _this2 = this;\n\n      var innerWidth = this.state.innerWidth;\n      var fauxDiv = ReactFauxDOM.createElement('div');\n      var activeNames = this.getActive();\n      var activeData = getDataActive(activeNames); // set the dimensions and margins of the graph\n\n      var margin = {\n        top: 20,\n        right: 22.5,\n        bottom: 30,\n        left: 37.5\n      },\n          padding = 2.5;\n      var width, height;\n\n      if (innerWidth > 1150) {\n        width = 940 - margin.right - margin.left;\n        height = 540 - margin.top - margin.bottom;\n      } else if (innerWidth < 1150 && innerWidth >= 750) {\n        width = innerWidth - 232 - margin.right - margin.left;\n        height = 540 - margin.top - margin.bottom - padding;\n      } else {\n        width = innerWidth - margin.right - margin.left;\n        height = 400 - margin.top - margin.bottom;\n      } // parse the date / time\n      // set the ranges\n\n\n      var x = d3.scaleTime().range([0, width]);\n      var y = d3.scaleLinear().range([height, 0]);\n      var svg = d3.select(fauxDiv).append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n      var parseYear = d3.timeParse(\"%Y\");\n      var domain = [1989, 2018];\n      x.domain(d3.extent(domain, function (d) {\n        return parseYear(d);\n      }));\n      y.domain([0, d3.max(getDomain(activeData), function (d) {\n        return d.val;\n      })]); // Accepts \"upper\", \"lower\", \"val\"\n\n      var valueline = function valueline(valueType) {\n        return d3.line().x(function (d) {\n          return x(new Date(d.year, 1, 1));\n        }).y(function (d) {\n          return y(d[valueType]);\n        });\n      };\n\n      var div = d3.select(\".Chart-Wrapper\").append(\"div\").attr(\"class\", \"tooltip\").style(\"opacity\", 0); // Add the X Axis\n\n      svg.append(\"g\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(x).ticks(5).tickSizeOuter(0).tickSize(0)).append(\"text\").attr('transform', \"translate(\" + width / 2 + \",\" + 27.5 + \")\").attr(\"font-size\", \"1.5em\").attr(\"text-anchor\", \"middle\").text(\"Year\"); // Add the Y Axis\n\n      svg.append(\"g\").call(d3.axisLeft(y).ticks(6).tickSizeOuter(0).tickSize(0)).append(\"text\").attr('transform', \"translate(\" + -27 + \",\" + height / 2 + \") rotate(-90)\").attr(\"text-anchor\", \"middle\").attr(\"font-size\", \"1.5em\").text(\"Fatalities per 100,000 Capita\");\n      ;\n      svg.selectAll(\".tick > text\").attr(\"font-size\", \"1.25em\");\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        var _loop = function _loop() {\n          var countryData = _step.value;\n\n          var cd = _this2.getDataFor(countryData);\n\n          var linePlot = svg.append(\"g\").attr(\"class\", \"linePlot\");\n          linePlot.append(\"path\").datum(cd).attr(\"class\", \"line\").attr(\"d\", valueline(\"val\")).attr(\"stroke-width\", \"2.5px\").attr(\"stroke\", colors[countryData.name]).attr('color', colors[countryData.name]).attr(\"fill\", 'none');\n          linePlot.selectAll(\".linePlotPoint\").data(cd).enter().append(\"circle\").attr(\"class\", \"linePlotPoint\").attr(\"cx\", function (d, i) {\n            return x(new Date(d.year, 1, 1));\n          }).attr(\"cy\", function (d) {\n            return y(d.val);\n          }).attr(\"r\", 3).attr(\"stroke\", colors[countryData.name]).attr(\"fill\", colors[countryData.name]).on(\"mouseover\", function (d) {\n            div.transition().duration(200).style(\"opacity\", 0.9);\n            div.html(getTool(d, countryData.name)).style(\"left\", d3.event.pageX + 5 + \"px\").style(\"top\", d3.event.pageY - 28 + \"px\");\n          }).on(\"mouseout\", function (d) {\n            div.transition().duration(500).style(\"opacity\", 0);\n          });\n        };\n\n        for (var _iterator = activeData[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          _loop();\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return fauxDiv;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var FauxSvg = this.makeD3();\n      return FauxSvg.toReact();\n    }\n  }]);\n\n  return Chart;\n}(Component);\n\nvar getTool = function getTool(d, name) {\n  var year = d.year,\n      val = d.val,\n      upper = d.upper,\n      lower = d.lower;\n  val = val.toFixed(2);\n  upper = upper.toFixed(2);\n  lower = lower.toFixed(2);\n  return \"<span><span><b>\" + name + \"(\" + year + \")</b></span><br /><span>Value: \" + val + \"</span><br /><span>Upper: \" + upper + \"</span><br /><span>Lower: \" + lower + \"</span></span>\";\n}; // data transformatiuon helper functions\n\n\nvar getDataFor = function getDataFor(country) {\n  return {\n    name: country.name,\n    data: data[[country.name]]\n  };\n};\n\nvar getDomain = function getDomain(countries) {\n  var d = [{\n    val: 3.0\n  }];\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = countries[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var c = _step2.value;\n      d = d.concat(c.data['Both']);\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  return d;\n};\n\nvar getDataActive = function getDataActive(countries) {\n  var activeData = [];\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    for (var _iterator3 = countries[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      var c = _step3.value;\n      activeData.push(getDataFor(c));\n    }\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  return activeData;\n};\n\nexport default sizeMe()(ReactFauxDOM.withFauxDOM(Chart));","map":{"version":3,"sources":["/Users/fernb0t/Code/react/Opioid Crisis/src/Components/Chart/Chart.js"],"names":["React","Component","d3","ReactFauxDOM","data","colors","sizeMe","Chart","props","state","innerWidth","window","makeD3","bind","getActive","getDataFor","updateDimensions","countries","active","filter","el","country","gender","sort","a","b","year","setState","addEventListener","fauxDiv","createElement","activeNames","activeData","getDataActive","margin","top","right","bottom","left","padding","width","height","x","scaleTime","range","y","scaleLinear","svg","select","append","attr","parseYear","timeParse","domain","extent","d","max","getDomain","val","valueline","valueType","line","Date","div","style","call","axisBottom","ticks","tickSizeOuter","tickSize","text","axisLeft","selectAll","countryData","cd","linePlot","datum","name","enter","i","on","transition","duration","html","getTool","event","pageX","pageY","FauxSvg","toReact","upper","lower","toFixed","c","concat","push","withFauxDOM"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport * as ReactFauxDOM from 'react-faux-dom';\nimport data from \"../../Resources/data.json\";\nimport colors from \"../../Resources/colors.json\";\nimport sizeMe from \"react-sizeme\";\n\nclass Chart extends Component {\n    constructor(props){\n        super(props);\n        this.state = { innerWidth: window.innerWidth }\n\n        this.makeD3 = this.makeD3.bind(this);\n        this.getActive = this.getActive.bind(this);\n        this.getDataFor = this.getDataFor.bind(this);\n        this.updateDimensions = this.updateDimensions.bind(this);\n    }\n\n    getActive(){\n        let countries = this.props.countries;\n        let active = countries.filter(el => el.active === true); // I have no idea but this call drops data.....\n        return active;\n    }\n\n    getDataFor(country, gender=\"Both\"){\n        return country['data'][[gender]].sort(function(a, b){return a.year - b.year});\n    }\n\n    updateDimensions(){\n        this.setState({innerWidth: window.innerWidth})\n    }\n    \n    componentDidMount() {\n        window.addEventListener(\"resize\", this.updateDimensions);\n    }\n\n    makeD3(){\n        const innerWidth = this.state.innerWidth;\n        let fauxDiv = ReactFauxDOM.createElement('div');  \n\n        const activeNames = this.getActive();\n        const activeData = getDataActive(activeNames)\n        \n        // set the dimensions and margins of the graph\n        const margin = {top: 20, right: 22.5, bottom: 30, left: 37.5},\n              padding = 2.5;\n        \n        \n        let width, height;\n\n        if(innerWidth > 1150){\n            width = 940 - margin.right - margin.left;\n            height = 540 - margin.top - margin.bottom;\n        } else if(innerWidth < 1150 && innerWidth >= 750 ){\n            width = innerWidth - 232 - margin.right - margin.left;\n            height = 540 - margin.top - margin.bottom - padding;\n        } else {\n            width = innerWidth - margin.right - margin.left;\n            height = 400 - margin.top - margin.bottom;\n        }\n        // parse the date / time\n        // set the ranges\n        const x = d3.scaleTime().range([0, width]);\n        const y = d3.scaleLinear().range([height, 0]);\n\n        let svg = d3.select(fauxDiv).append(\"svg\")\n                    .attr(\"width\", width + margin.left + margin.right)\n                    .attr(\"height\", height + margin.top + margin.bottom)\n                    .append(\"g\")\n                    .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        const parseYear = d3.timeParse(\"%Y\");\n        const domain = [1989, 2018];\n        x.domain(d3.extent(domain, function(d) { return parseYear(d) }));\n        y.domain([0, d3.max(getDomain(activeData), function(d) { return d.val; })]);\n\n        // Accepts \"upper\", \"lower\", \"val\"\n        const valueline = (valueType) =>{ \n            return d3.line()\n                    .x(function(d) { return x(new Date(d.year, 1, 1)); })\n                    .y(function(d) { return y(d[valueType]); }); \n        }\n\n        let div = d3.select(\".Chart-Wrapper\").append(\"div\")\n                        .attr(\"class\", \"tooltip\")\n                        .style(\"opacity\", 0);\n        \n        // Add the X Axis\n        svg.append(\"g\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call( d3.axisBottom(x).ticks(5).tickSizeOuter(0).tickSize(0) )\n            .append(\"text\")\n                .attr('transform', \"translate(\" +width / 2 + \",\" + 27.5 + \")\")\n                .attr(\"font-size\", \"1.5em\")\n                .attr(\"text-anchor\", \"middle\")\n                .text(\"Year\");\n\n        // Add the Y Axis\n        svg.append(\"g\")\n            .call( d3.axisLeft(y).ticks(6).tickSizeOuter(0).tickSize(0) )\n            .append(\"text\")\n                .attr('transform', \"translate(\" + -27 + \",\" + height / 2 + \") rotate(-90)\")\n                .attr(\"text-anchor\", \"middle\")\n                .attr(\"font-size\", \"1.5em\")\n                .text(\"Fatalities per 100,000 Capita\");;\n        \n        svg.selectAll(\".tick > text\")\n                .attr(\"font-size\", \"1.25em\")\n\n        for( let countryData of activeData ){\n            const cd = this.getDataFor( countryData );\n            \n            let linePlot = svg.append(\"g\").attr(\"class\", \"linePlot\");\n            \n            linePlot.append(\"path\")\n                        .datum( cd )\n                        .attr(\"class\", \"line\")\n                        .attr(\"d\",valueline(\"val\"))\n                        .attr(\"stroke-width\", \"2.5px\")\n                        .attr(\"stroke\", colors[countryData.name])\n                        .attr('color', colors[countryData.name])\n                        .attr(\"fill\", 'none')\n\n            linePlot.selectAll(\".linePlotPoint\").data( cd )\n                        .enter().append(\"circle\") \n                        .attr(\"class\", \"linePlotPoint\")\n                        .attr(\"cx\", function(d, i) { return x(new Date(d.year, 1, 1)) })\n                        .attr(\"cy\", function(d) { return y(d.val) })\n                        .attr(\"r\", 3)\n                        .attr(\"stroke\", colors[countryData.name])\n                        .attr(\"fill\", colors[countryData.name])\n                        .on(\"mouseover\", function(d) {\n                            div.transition() \n                                .duration(200)\n                                .style(\"opacity\", 0.9);\n                            div.html( getTool(d, countryData.name) )\n                                .style(\"left\", (d3.event.pageX) +5 + \"px\")\n                                .style(\"top\", (d3.event.pageY - 28) + \"px\"); })\n                        .on(\"mouseout\", function(d) {\n                                div.transition()\n                                    .duration(500)\n                                    .style(\"opacity\", 0); });       \n            }\n\n        return fauxDiv;\n    }\n\n    render() {\n        let FauxSvg = this.makeD3();\n\n        return (\n            FauxSvg.toReact()\n        );\n    }\n}\n\nconst getTool = (d, name) => {\n    let {year, val, upper, lower} = d;\n    val = val.toFixed(2);\n    upper = upper.toFixed(2);\n    lower = lower.toFixed(2);\n    return ( \n        \"<span><span><b>\" +  name + \"(\" + year + \")</b></span><br /><span>Value: \" + val + \"</span><br /><span>Upper: \" + upper + \"</span><br /><span>Lower: \" + lower + \"</span></span>\"\n    ) \n}\n\n// data transformatiuon helper functions\nconst getDataFor = (country) =>{\n    return { \n        name:country.name, \n        data:data[[country.name]]\n    }\n}\n\nconst getDomain = (countries) =>{\n    let d = [{val:3.0}]\n    for(let c of countries){\n        d = d.concat(c.data['Both']);\n    }\n    return d\n}\n\nconst getDataActive = (countries) =>{\n    let activeData = []\n    for(let c of countries){\n        activeData.push(getDataFor(c));\n    }\n    return activeData;\n}\n\nexport default sizeMe()(ReactFauxDOM.withFauxDOM(Chart));\n"]},"metadata":{},"sourceType":"module"}